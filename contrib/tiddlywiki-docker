#!/usr/bin/env bash

#
# tiddlywiki-docker
#
# Run an interactive TiddlyWiki command with the host's current working
# directory bind mounted inside the Docker container's data volume.
#

[[ -n $DEBUG ]] && set -o xtrace

readonly TIDDLYWIKI_DOCKER_TAG="${TIDDLYWIKI_DOCKER_TAG:-latest}"

docker run --interactive --tty --rm \
	--env-file <(env | grep ^TIDDLYWIKI_) \
	--publish 127.0.0.1:8080:8080 \
	--mount "type=bind,source=${PWD},target=/tiddlywiki" \
	--user "$(id -u):$(id -g)" \
	"elasticdog/tiddlywiki:${TIDDLYWIKI_DOCKER_TAG}" \
	"$@"
